<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>测试音乐播放管理器</title>
	</head>
	<body>
		<h3>测试音乐播放管理器</h3>
		
		<button type="button" onclick="play()">第一次播放</button>
		<button type="button" onclick="playOrPause()" id="playOrPause">播放或暂停</button>
		<button type="button" onclick="onSeekClick()">跳转到30秒</button>
		<button type="button" onclick="setLooping()">开启或禁用循环播放</button>
		
		<p>
			音量<input type="range" id="volumeInput" min="0" max="1" step="0.1" oninput="onVolumechanged(this.value)"/>
		</p>
		
		<p>时长：<span id="duration"></span></p>
		
		<p>进度：<span id="progress"></span></p>
		
		<p>错误：<span id="error"></span></p>
		
		<!-- ==================通用资源 -->
		<!-- jquery框架 -->
		<script src="../vender/jquery/jquery.min.js" crossorigin="anonymous"></script>
		<!-- /==================通用资源 -->
		
		<!-- 播放管理器监听器 -->
		<script src="../js/player/MusicPlayerListener.js"></script>
		<!-- 播放管理器 -->
		<script src="../js/player/MusicPlayerManager.js"></script>
		<script src="../js/constants.js"></script>
		<script src="../js/common.js"></script>
		
		
		<script type="text/javascript">
			//创建播放管理器
			musicPlayerManager = new MusicPlayerManager();
			
			//创建播放管理器监听器
			var listener = new MusicPlayerListener();
			
			//设置要关注的事件
			//准备完毕了
			listener.onPrepared = function(data){
				$("#duration").text(data.duration);
			}
			//播放进度
			listener.onProgress = function(data){
				$("#progress").text(data.duration);
			}
			//已经播放了
			listener.onPlaying = function(data){
				$("#playOrPause").text("暂停");
			}
			//暂停了
			listener.onPaused = function(data){
				$("#playOrPause").text("继续播放");
			}
			//出错了
			listener.onError = function(data, error){
				$("#error").text("出错了，错误码:"+ error.code);
			}
			
			
			//添加监听器到播放管理器
			musicPlayerManager.addMusicPlayerListener(listener);
			
			
			
			//第一次播放
			function play(){
				musicPlayerManager.play('//dev-courses-misuc.ixuea.com/assets/yong_bao_ni_de_ni_de_li_qu.mp3',{"name":"这是测试对象"});
			}
			
			/**
			 * 播放或暂停
			 */
			function playOrPause(){
				if(musicPlayerManager.isPlaying()){
					//在播放，则暂停
					musicPlayerManager.pause();
				}else{
					//没有播放，则开始播放
					musicPlayerManager.resume();
				}
			}
			/**
			 * 从指定位置播放
			 * @param {number} progress
			 */
			function onSeekClick(progress){
				musicPlayerManager.seekTo(33);
			}
			/**
			 * 设置循环播放
			 */
			function setLooping(){
				musicPlayerManager.setLooping(true);
			}
			/**
			 * 音量进度值改变了
			 */
			function onVolumechanged(data){
				musicPlayerManager.setVolume(data);
			}
			
		</script>
		
	</body>
</html>